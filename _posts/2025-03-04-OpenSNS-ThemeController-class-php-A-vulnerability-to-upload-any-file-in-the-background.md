# OpenSNS ThemeController.class.php Any file upload vulnerability in the background

## Vulnerability Description

There is file upload in the OpenSNS ThemeController.class.php file, where insufficient filtering causes any file to be uploaded to the server.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">OpenSNS</span>

## Network surveying and mapping

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">icon_hash="1167011145"</span>

## Vulnerability reappears

The login page is as follows

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1634371874190-3653480e-380a-4cdc-81fc-7d560bc7d0dc-20220313235625660.png)

Upload page after login `/admin.php?s=/theme/add.html`

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1634375246360-20a15b56-e288-4148-a3e0-b7882cf24a8f.png)

The vulnerable file is `Application/Admin/Model/ThemeController.class.php`

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1634375007934-e879d659-e3fd-4f35-83ea-055ff18a4142.png)

Only if the file suffix is ​​zip and rar, it will be successfully uploaded and decompressed to the current Theme directory.

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1634375315209-5795c6ea-3f6d-433a-9aef-686b03ccd1db.png)