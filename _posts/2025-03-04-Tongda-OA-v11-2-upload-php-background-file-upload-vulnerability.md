# Tongda OA v11.2 upload.php background file upload vulnerability

## Vulnerability Description

There is a file upload vulnerability in the background of Tongda OA v11.2, allowing malicious files to be uploaded by bypassing the blacklist, resulting in the server being attacked.

## Affect Version

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">Tongda OA v11.2</span>

## Environment construction

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">Tongda OA v11.2 download link: https://cdndown.tongda2000.com/oa/2019/TDOA11.2.exe</span>

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">After downloading, follow the steps to install</span>

## Vulnerability reappears

This vulnerability exists in the background and needs to be used after logging in

After logging in, click `Menu -> System Management -> Attachment Management`

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/tongdaoa-13.png)



Click Add Appendix to add the following storage management (the storage directory is webroot directory, default is `D:/MYOA/webroot/`)

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/tongdaoa-14.png)

Click `Organization -> System Administrator -> Upload attachments`

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/tongdaoa-15.png)

Bypass method of using windows to catch packets `shell.php -> shell.php.`

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/tongdaoa-16.png)

- ✅2012 as a directory
- ✅1717872192 The spliced ​​file name
- ✅The last shell name is 1717872192.shell.php



![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/tongdaoa-17.png)



Access Trojan files

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/tongdaoa-18.png)