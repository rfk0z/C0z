# YzmCMS background acquisition module SSRF vulnerability

## Vulnerability Description

[YzmCMS Content Management System](https://www.yzmcms.com/) is a `lightweight open source content management system` which is developed using the independent research and development framework `YZMPHP`. 



The source code has a defect in protocol identification, resulting in an SSRF vulnerability

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">YzmCMS version < V5.8 official version</span>

## Environment construction


</a-alert>
<br/>

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/yzmcms-1.png)



## Vulnerability reappears



Log in to the background --> Module management --> Collection management

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/image-20220313234840629.png)

Add collection rules



![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/yzmcms-4.png)



Edit HTML code on your server



![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/yzmcms-5.png)



The root directory may be different, the payload needs to be changed

Click to collect and read the flag in the root directory

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/yzmcms-3.png)



The code location where the vulnerability occurs `yzmcms/yzmphp/core/class/cache_factory.class.php`



![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/yzmcms-6.png)



Call the `*url_check`* function here



![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/yzmcms-7.png)



You can see that only the first 4 digits are http. You can bypass it by using httpxxx